{% extends "feed/base.html" %}

{% block title %}Create Story{% endblock %}

{% block content %}
<div class="story-composer-container">
    <div class="composer-header">
        <a href="{{ url_for('feed.home') }}" class="close-composer">&times;</a>
        <h2>Create Story</h2>
    </div>

    <div class="composer-tabs">
        <button class="tab-link active" onclick="openTab(event, 'media-tab')">Media</button>
        <button class="tab-link" onclick="openTab(event, 'text-tab')">Text</button>
    </div>

    <form action="{{ url_for('feed.create_story') }}" method="POST" enctype="multipart/form-data">
        <div id="media-tab" class="tab-content active">
            <div class="form-group">
                <label for="media_file">Upload Photo or Video</label>
                <input type="file" name="media_file" id="media_file" accept="image/*,video/*" required>
            </div>
        </div>

        <div id="text-tab" class="tab-content">
            <div class="form-group">
                <textarea name="text_content" placeholder="Start typing" class="text-story-input"></textarea>
                <div class="color-palette">
                    <label>Background</label>
                    <input type="color" name="background_color" value="#6B5B95">
                </div>
            </div>
        </div>

        <input type="hidden" name="story_type" id="story_type" value="media">
        <button type="submit" class="btn-primary post-story-btn">Post Story</button>
    </form>
</div>

<script>
function openTab(evt, tabName) {
    var i, tabcontent, tablinks;
    tabcontent = document.getElementsByClassName("tab-content");
    for (i = 0; i < tabcontent.length; i++) {
        tabcontent[i].style.display = "none";
    }
    tablinks = document.getElementsByClassName("tab-link");
    for (i = 0; i < tablinks.length; i++) {
        tablinks[i].className = tablinks[i].className.replace(" active", "");
    }
    document.getElementById(tabName).style.display = "block";
    evt.currentTarget.className += " active";
    document.getElementById('story_type').value = tabName === 'media-tab' ? 'media' : 'text';
}
document.addEventListener('DOMContentLoaded', () => {
    document.querySelector('.tab-link.active').click();
});
</script>
{% endblock %}
