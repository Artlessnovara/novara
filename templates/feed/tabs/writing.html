<div class="upload-work-section">
    <h3>Share Your Writing</h3>
    <form action="{{ url_for('feed.create_creative_work') }}" method="POST" enctype="multipart/form-data">
        <input type="hidden" name="category" value="writing">
        <div>
            <label for="title">Title (e.g., "My First Poem", "A Short Story")</label>
            <input type="text" id="title" name="title" required>
        </div>
        <div style="margin-top: 1rem;">
            <label for="sub_category">Sub-Category</label>
            <select name="sub_category" id="sub_category">
                <option value="">All Writing</option>
                <option value="poetry">Poetry</option>
                <option value="quotes">Quotes</option>
                <option value="stories">Stories</option>
                <option value="essays">Essays</option>
            </select>
        </div>
        <div style="margin-top: 1rem;">
            <label for="description">Your Text</label>
            <textarea name="description" id="description" rows="10" required placeholder="Write your poem, story, or quote here..."></textarea>
        </div>
        <div style="margin-top: 1rem;">
            <label for="tags">Tags (comma-separated)</label>
            <input type="text" id="tags" name="tags" placeholder="e.g., poetry, shortstory, personal">
        </div>
        <div style="margin-top: 1rem;">
            <label>Choose a Background Style</label>
            <div class="style-selector">
                <input type="radio" id="bg-default" name="bg_style" value="default" checked>
                <label for="bg-default" class="style-option" style="background: #fff; border: 1px solid #ddd;">Default</label>

                <input type="radio" id="bg-dark" name="bg_style" value="dark">
                <label for="bg-dark" class="style-option" style="background: #333; color: #fff;">Dark</label>

                <input type="radio" id="bg-parchment" name="bg_style" value="parchment">
                <label for="bg-parchment" class="style-option" style="background: #fdf5e6;">Parchment</label>

                <input type="radio" id="bg-blue" name="bg_style" value="blue">
                <label for="bg-blue" class="style-option" style="background: #e7f3ff;">Light Blue</label>
            </div>
        </div>
        <button type="submit">Publish Writing</button>
    </form>
</div>

<div class="filters-bar">
    <form action="{{ url_for('feed.creativity', category='writing') }}" method="GET">
        <label for="writing_filter">Filter by:</label>
        <select name="filter" id="writing_filter" onchange="this.form.submit()">
            <option value="all" {% if request.args.get('filter') == 'all' %}selected{% endif %}>All</option>
            <option value="poetry" {% if request.args.get('filter') == 'poetry' %}selected{% endif %}>Poetry</option>
            <option value="quotes" {% if request.args.get('filter') == 'quotes' %}selected{% endif %}>Quotes</option>
            <option value="stories" {% if request.args.get('filter') == 'stories' %}selected{% endif %}>Stories</option>
            <option value="essays" {% if request.args.get('filter') == 'essays' %}selected{% endif %}>Essays</option>
        </select>
    </form>
</div>

<div class="writing-list">
    {% for work in works %}
        {% if work.work_type == 'writing' %}
            {% include 'feed/partials/_writing_card.html' %}
        {% endif %}
    {% else %}
        <p>No writings yet. Be the first to share something!</p>
    {% endfor %}
</div>

<style>
.style-selector { display: flex; gap: 10px; margin-top: 5px; }
.style-selector input[type="radio"] { display: none; }
.style-selector .style-option {
    padding: 10px 15px;
    border-radius: 5px;
    cursor: pointer;
    transition: transform 0.2s;
}
.style-selector input[type="radio"]:checked + .style-option {
    transform: scale(1.1);
    box-shadow: 0 0 0 2px var(--primary-color);
}

.writing-list { column-count: 1; column-gap: 1rem; }
.writing-card {
    display: inline-block;
    width: 100%;
    margin-bottom: 1rem;
    padding: 1.5rem;
    border-radius: var(--border-radius);
    box-shadow: var(--shadow-sm);
    border: 1px solid var(--border-color-light);
    break-inside: avoid;
}
.writing-card a { text-decoration: none; color: inherit; }
.writing-card h3 { margin-top: 0; }
.writing-card .author { font-size: 0.9rem; color: var(--secondary-text-light); }
.writing-card hr { border: 0; border-top: 1px solid var(--border-color-light); margin: 1rem 0; }
.writing-card .writing-body { white-space: pre-wrap; line-height: 1.6; }
.writing-card-footer { margin-top: 1rem; display: flex; gap: 1rem; color: var(--secondary-text-light); }

@media (min-width: 768px) {
    .writing-list { column-count: 2; }
}
@media (min-width: 1024px) {
    .writing-list { column-count: 3; }
}
</style>
