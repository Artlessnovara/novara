{% extends "feed/base.html" %}

{% block title %}{{ user.name }}'s Profile{% endblock %}

{% block head %}
{{ super() }}
<link rel="stylesheet" href="{{ url_for('static', filename='css/profile_new.css') }}">
{% endblock %}

{% block content %}
<div class="profile-container">
    {% if profile_completion < 100 %}
    <div class="completion-banner">
        Your profile is only {{ profile_completion }}% complete. <a href="#">Complete it now!</a>
    </div>
    {% endif %}
    <div class="profile-header" style="background-image: url({{ url_for('static', filename=user.profile_banner_url or 'images/course_placeholder.jpg') }})">
        <div class="profile-header-content">
            <div class="profile-pic">
                <img src="{{ url_for('static', filename='profile_pics/' + user.profile_pic) }}" alt="{{ user.name }}'s profile picture">
            </div>
            <div class="profile-info">
                <h1>{{ user.name }}</h1>
                <p class="tagline">{{ user.bio or 'Eager to learn and grow.' }}</p>
                <div class="profile-actions">
                    <button class="btn btn-primary">Edit Profile</button>
                </div>
            </div>
        </div>
    </div>

    <div class="profile-stats">
        <div class="stat-card">
            <h3>Profile Completion</h3>
            <p class="stat-number">85%</p>
        </div>
        <div class="stat-card">
            <h3>Certificates</h3>
            <p class="stat-number">{{ user.certificates.count() }}</p>
        </div>
        <div class="stat-card">
            <h3>Badges</h3>
            <p class="stat-number">{{ user.badges.count() }}</p>
        </div>
    </div>

    <div class="profile-certificates">
        <div class="section-header">
            <h2>My Certificates</h2>
            <button class="btn-add">+ Add</button>
        </div>
        <div class="certificates-grid">
            {% for cert in user.certificates %}
            <div class="certificate-card">
                <div class="cert-icon"><i class="fas fa-award"></i></div>
                <div class="cert-details">
                    <h4>{{ cert.course.title }}</h4>
                    <p>Issued: {{ cert.issued_at.strftime('%b %Y') }}</p>
                </div>
            </div>
            {% else %}
            <p>No certificates yet.</p>
            {% endfor %}
        </div>
        <a href="#" class="view-all-link">View All</a>
    </div>

    <div class="profile-badges">
        <div class="section-header">
            <h2>Achievements & Badges</h2>
        </div>
        <div class="badges-carousel">
            {% for badge in user.badges %}
            <div class="badge-item">
                <img src="{{ badge.icon_url or url_for('static', filename='images/course_placeholder.jpg') }}" alt="{{ badge.name }}">
                <p>{{ badge.name }}</p>
            </div>
            {% else %}
            <p>No badges earned yet.</p>
            {% endfor %}
        </div>
    </div>

    <div class="profile-details">
        <div class="section-header">
            <h2>Profile Details</h2>
        </div>
        <div class="details-grid">
            <div class="detail-card">
                <strong>Full Name</strong>
                <p>{{ user.name }}</p>
                <button class="btn-edit-detail"><i class="fas fa-pencil-alt"></i></button>
            </div>
            <div class="detail-card">
                <strong>Email Address</strong>
                <p>{{ user.email }}</p>
                <button class="btn-edit-detail"><i class="fas fa-pencil-alt"></i></button>
            </div>
            <div class="detail-card">
                <strong>Role</strong>
                <p>{{ user.role.capitalize() }}</p>
            </div>
        </div>
    </div>

    <div class="profile-social-links">
        <div class="section-header">
            <h2>Social Links</h2>
        </div>
        <div class="social-links-row">
            {% for link in user.social_links %}
            <a href="{{ link.url }}" target="_blank" class="social-link-btn">
                <i class="fab fa-{{ link.platform | lower }}"></i>
            </a>
            {% else %}
            <p>No social links yet.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
