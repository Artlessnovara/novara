{% extends "layouts/dashboard_layout.html" %}

{% block dashboard_content %}
<div class="content-header">
    <h1 class="fade-in">{{ assignment.title }}</h1>
    <p class="fade-in" style="animation-delay: 0.2s;">{{ assignment.module.course.title }}</p>
</div>

<div class="dashboard-main-grid">
    <div class="grid-col-left">
        <div class="card">
            <div class="card-header">
                <h3>Assignment Details</h3>
            </div>
            <div class="card-body" style="padding: 1.5rem;">
                {{ assignment.description | safe }}
            </div>
        </div>
    </div>
    <div class="grid-col-right">
        <div class="card">
            <div class="card-header">
                <h3>Submission</h3>
            </div>
            <div class="card-body" style="padding: 1.5rem;">
                {% if submission %}
                    <p><strong>Status:</strong> {{ submission.grade if submission.grade else 'Submitted' }}</p>
                    <p><strong>Submitted at:</strong> {{ submission.submitted_at.strftime('%B %d, %Y at %I:%M %p') }}</p>
                    {% if submission.text_submission %}
                        <div class="submission-text">
                            <h4>Text Submission:</h4>
                            <pre>{{ submission.text_submission }}</pre>
                        </div>
                    {% endif %}
                    {% if submission.file_path %}
                        <div class="submission-file">
                            <h4>File Submission:</h4>
                            <a href="{{ url_for('static', filename='assignments/' + submission.file_path) }}" target="_blank">Download File</a>
                        </div>
                    {% endif %}
                {% else %}
                    <form action="{{ url_for('main.submit_assignment', assignment_id=assignment.id) }}" method="POST" enctype="multipart/form-data">
                        {% if assignment.submission_type in ['text', 'both'] %}
                        <div class="form-group">
                            <label for="text_submission">Text Submission</label>
                            <textarea name="text_submission" id="text_submission" rows="5" class="form-control"></textarea>
                        </div>
                        {% endif %}
                        {% if assignment.submission_type in ['file', 'both'] %}
                        <div class="form-group">
                            <label for="file_submission">File Submission</label>
                            <input type="file" name="file_submission" id="file_submission" class="form-control-file">
                        </div>
                        {% endif %}
                        <button type="submit" class="btn-primary-gradient">Submit Assignment</button>
                    </form>
                {% endif %}
            </div>
        </div>
    </div>
</div>
{% endblock %}
